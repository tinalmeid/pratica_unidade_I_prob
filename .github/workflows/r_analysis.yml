name: ğŸ“Š AnÃ¡lise PRF 2024 | ğŸ§¬ EstatÃ­stica e Probabilidade Unidade I

# Define quais eventos disparam a execuÃ§Ã£o automÃ¡tica.
on:
  push:
    branches:
      -  main  # Em novos commits para a branch main
  pull_request:
    types: [ opened, synchronize, reopened ] # Em pull requests para a branch main

jobs:
  build:
    # Maquina virtual onde a aÃ§Ã£o serÃ¡ executada
    runs-on: ubuntu-latest
    steps:
      # 1. Faz o checkout do cÃ³digo para a mÃ¡quina virtual
      - name: "ğŸ“‚ Sincronizando RepositÃ³rio"
        uses: actions/checkout@v3

      # 2. Configura o ambiente R 4.5.2
      - name: "âš™ï¸ Configurando Engine R (4.5.2)"
        uses: r-lib/actions/setup-r@v2
        with:
          r-version: '4.5.2' # Minha versÃ£o especÃ­fica do R

      # 3. Gerenciamento e instalaÃ§Ã£o de pacotes necessÃ¡rios
      - name: "ğŸ“¦ Instalando Bibliotecas (dplyr, ggplot2, scales, testthat)"
        run: |
          install.packages(c("dplyr", "ggplot2", "scales", "testthat"), repos = "https://cloud.r-project.org/")
        shell: Rscript {0}

      # 4. Executa o script de anÃ¡lise de dados da PRF
      - name: "ğŸš€ Executando AnÃ¡lise EstatÃ­stica"
        run: |
          source("scripts/aulaPratica_U1.R")
        shell: Rscript {0}

      # 5. Executa os testes unitÃ¡rios para validar a anÃ¡lise
      - name: "ğŸ§ª Executando Testes UnitÃ¡rios"
        run: |
          library(testthat)
          test_dir("tests")
        shell: Rscript {0}

      # 6. Salva os resultados (GrÃ¡ficos) como artefatos de build
      - name: "ğŸ–¼ï¸ Salvando Resultados (GrÃ¡ficos)"
        uses: actions/upload-artifact@v3
        with:
          name: "Relatorio_Visual_PRF"
          path: grafico_uf.png
